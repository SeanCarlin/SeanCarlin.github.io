<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Prime Spiral</title>
<style>
body {margin: 0; background: #000;}
canvas {
	display: block;
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translateX(-50%) translateY(-50%);
}
</style>
</head>
<body>
<canvas id="c"></canvas>
<script>

c.width = 500;
c.height = 500;

var size = 2,
	cx = c.getContext("2d"),
	order = ["r", "u", "l", "d"];

function prime(p){
	var i;

	if (p % 2 === 0 && p !== 2 || p === 1){
		return false;
	} else {
		for (i = 3; i < p/2; i+=2){
			if (p % i === 0){
				return false;
			}
		}
	}
	return true;
}

function color(x,y){
	var diffX = Math.abs(c.width/2 - x),
		diffY = Math.abs(c.height/2 - y),
		h = Math.sqrt((diffX*diffX + diffY*diffY)),
		totalDiff, transparency;
	
	totalDiff = Math.sqrt(Math.pow(c.width/2, 2) + Math.pow(c.height/2, 2));
	transparency = (totalDiff - h)/totalDiff;
	return "rgba(0,255,255,"+transparency+")";
}

var x = c.width/2,
	y = c.height/2,
	n = 0,
	m = 1,
	count = 0,
	tCount = 1,
	dir = order[n];

var i = 1;
function mainloop(){
	
	cx.fillStyle = color(x,y);
	
	if (count === tCount){
		m++;
		if (m === 3){
		  tCount++;
			m = 1;
		}
		
		count = 0;
		n++;
		dir = order[n % order.length];
	}
	
	if(prime(i)){
		cx.fillRect(x,y,size,size);
	}
	
	if (dir == "r"){
		x+=size;
	}
		
	if (dir == "u"){
		y-=size;
	}

	if (dir == "l"){
		x-=size;
	}

	if (dir == "d"){
		y+=size;
	}

	
	i++;
	count++;
	
	if (i >= c.width*c.height/Math.pow(size,2)){
		clearInterval(loop);
	}
}

var loop = setInterval(mainloop,1);

</script>
</body>
</html>